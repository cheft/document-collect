<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
html { font-size: 100%; overflow-y: scroll; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; }

body{
  color:#444;
  font-family:Georgia, Palatino, 'Palatino Linotype', Times, 'Times New Roman',
              "Hiragino Sans GB", "STXihei", "微软雅黑", serif;
  font-size:12px;
  line-height:1.5em;
  background:#fefefe;
  width: 45em;
  margin: 10px auto;
  padding: 1em;
  outline: 1300px solid #FAFAFA;
}

a{ color: #0645ad; text-decoration:none;}
a:visited{ color: #0b0080; }
a:hover{ color: #06e; }
a:active{ color:#faa700; }
a:focus{ outline: thin dotted; }
a:hover, a:active{ outline: 0; }

span.backtick {
  border:1px solid #EAEAEA;
  border-radius:3px;
  background:#F8F8F8;
  padding:0 3px 0 3px;
}

::-moz-selection{background:rgba(255,255,0,0.3);color:#000}
::selection{background:rgba(255,255,0,0.3);color:#000}

a::-moz-selection{background:rgba(255,255,0,0.3);color:#0645ad}
a::selection{background:rgba(255,255,0,0.3);color:#0645ad}

p{
margin:1em 0;
}

img{
max-width:100%;
}

h1,h2,h3,h4,h5,h6{
font-weight:normal;
color:#111;
line-height:1em;
}
h4,h5,h6{ font-weight: bold; }
h1{ font-size:2.5em; }
h2{ font-size:2em; border-bottom:1px solid silver; padding-bottom: 5px; }
h3{ font-size:1.5em; }
h4{ font-size:1.2em; }
h5{ font-size:1em; }
h6{ font-size:0.9em; }

blockquote{
color:#666666;
margin:0;
padding-left: 3em;
border-left: 0.5em #EEE solid;
}
hr { display: block; height: 2px; border: 0; border-top: 1px solid #aaa;border-bottom: 1px solid #eee; margin: 1em 0; padding: 0; }


pre , code, kbd, samp { 
  color: #000; 
  font-family: monospace; 
  font-size: 0.88em; 
  border-radius:3px;
  background-color: #F8F8F8;
  border: 1px solid #CCC; 
}
pre { white-space: pre; white-space: pre-wrap; word-wrap: break-word; padding: 5px 12px;}
pre code { border: 0px !important; padding: 0;}
code { padding: 0 3px 0 3px; }

b, strong { font-weight: bold; }

dfn { font-style: italic; }

ins { background: #ff9; color: #000; text-decoration: none; }

mark { background: #ff0; color: #000; font-style: italic; font-weight: bold; }

sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }
sup { top: -0.5em; }
sub { bottom: -0.25em; }

ul, ol { margin: 1em 0; padding: 0 0 0 2em; }
li p:last-child { margin:0 }
dd { margin: 0 0 0 2em; }

img { border: 0; -ms-interpolation-mode: bicubic; vertical-align: middle; }

table { border-collapse: collapse; border-spacing: 0; }
td { vertical-align: top; }

@media only screen and (min-width: 480px) {
body{font-size:14px;}
}

@media only screen and (min-width: 768px) {
body{font-size:16px;}
}

@media print {
  * { background: transparent !important; color: black !important; filter:none !important; -ms-filter: none !important; }
  body{font-size:12pt; max-width:100%; outline:none;}
  a, a:visited { text-decoration: underline; }
  hr { height: 1px; border:0; border-bottom:1px solid black; }
  a[href]:after { content: " (" attr(href) ")"; }
  abbr[title]:after { content: " (" attr(title) ")"; }
  .ir a:after, a[href^="javascript:"]:after, a[href^="#"]:after { content: ""; }
  pre, blockquote { border: 1px solid #999; padding-right: 1em; page-break-inside: avoid; }
  tr, img { page-break-inside: avoid; }
  img { max-width: 100% !important; }
  @page :left { margin: 15mm 20mm 15mm 10mm; }
  @page :right { margin: 15mm 10mm 15mm 20mm; }
  p, h2, h3 { orphans: 3; widows: 3; }
  h2, h3 { page-break-after: avoid; }
}
  
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
  </style>
</head>
<body>
<h2 id="归档服务组件-java-client端使用">归档服务组件 JAVA Client端使用</h2>
<h3 id="get-start">Get Start</h3>
<h4 id="将给定的依赖jar引入项目中在src目录下创建-setting.properties-配置文件修改-serviceurl-为asp.net-server端归档服务地址">将给定的依赖jar引入项目中，在src目录下创建 <em>setting.properties</em> 配置文件,修改 <em>serviceUrl</em> 为ASP.NET Server端归档服务地址</h4>
<pre><code>serviceUrl=http://172.18.80.79:12333/DocumentWebServcie.asmx</code></pre>
<h4 id="在客户端创建-servlet类接受服务端转换完成后的请求服务端会传回有三个参数-tag-isconvertedmsg修改asp.net-server端归档配置文件web.config-的javaserveron-javaserverurl-值">在客户端创建 Servlet类,接受服务端转换完成后的请求，服务端会传回有三个参数 tag， isConverted，msg，修改ASP.NET Server端归档配置文件web.config 的JavaServerOn , JavaServerUrl 值</h4>
<pre class="sourceCode xml"><code class="sourceCode xml"><span class="kw">&lt;appSettings&gt;</span>
    <span class="co">&lt;!-- 省略 --&gt;</span>
    <span class="kw">&lt;add</span><span class="ot"> key=</span><span class="st">&quot;JavaServerOn&quot;</span><span class="ot"> value=</span><span class="st">&quot;1&quot;</span><span class="kw">/&gt;</span>     <span class="co">&lt;!--是否向客户端传回转换日志--&gt;</span>
    <span class="kw">&lt;add</span><span class="ot"> key=</span><span class="st">&quot;JavaServerUrl&quot;</span><span class="ot"> value=</span><span class="st">&quot;http://172.18.97.60:8080/Project/ServletUrl&quot;</span><span class="kw">/&gt;</span>  <span class="co">&lt;!--客户端传回转换日志请求地址--&gt;</span>
<span class="kw">&lt;/appSettings&gt;</span>

<span class="er">&lt;</span>/log4net&gt;</code></pre>
<pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="kw">class</span> ServletTest <span class="kw">extends</span> HttpServlet {       
    <span class="kw">protected</span> <span class="dt">void</span> <span class="fu">doPost</span>(HttpServletRequest request, HttpServletResponse response) <span class="kw">throws</span> ServletException, IOException {
        String tag = request.<span class="fu">getParameter</span>(<span class="st">&quot;tag&quot;</span>);    <span class="co">// 文档Id</span>
        <span class="dt">boolean</span> isConverted = <span class="kw">new</span> Boolean(request.<span class="fu">getParameter</span>(<span class="st">&quot;isConverted&quot;</span>)).<span class="fu">booleanValue</span>(); <span class="co">// 是否转换成功</span>
        String msg = request.<span class="fu">getParameter</span>(<span class="st">&quot;msg&quot;</span>);    <span class="co">// 转换错误信息</span>
        <span class="co">//TODO 转换响应之后客户端的逻辑处理</span>
    }
}</code></pre>
<h3 id="demo">Demo</h3>
<pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">test2003</span>(String name) {
    DocumentClient client = <span class="kw">new</span> <span class="fu">DocumentClient</span>(name);
    client.<span class="fu">insertPageBreak</span>();
    client.<span class="fu">insertFrontCover</span>(<span class="st">&quot;D:</span><span class="ch">\\</span><span class="st">office-test</span><span class="ch">\\</span><span class="st">doc</span><span class="ch">\\</span><span class="st">temp.doc&quot;</span>,
            <span class="st">&quot;%author%风,%date%2012-09-08&quot;</span>);
    client.<span class="fu">insertPageBreak</span>();
    client.<span class="fu">insertTitle</span>(<span class="st">&quot;测试&quot;</span>);
    client.<span class="fu">insertLineBreak</span>(<span class="dv">2</span>);
    client.<span class="fu">insertHeading</span>(<span class="st">&quot;第一章&quot;</span>, <span class="dv">1</span>);
    client.<span class="fu">insertHeading</span>(<span class="st">&quot;背景&quot;</span>, <span class="dv">2</span>);
    client.<span class="fu">insertContent</span>(<span class="st">&quot;正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正正&quot;</span>
            + <span class="st">&quot;正文文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文&quot;</span>
            + <span class="st">&quot;正文文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文&quot;</span>
            + <span class="st">&quot;正文文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文&quot;</span>
            + <span class="st">&quot;正文文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文&quot;</span>
            + <span class="st">&quot;正文文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文&quot;</span>
            + <span class="st">&quot;正文文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文&quot;</span>
            + <span class="st">&quot;正文文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文&quot;</span>);
    client.<span class="fu">insertHeading</span>(<span class="st">&quot;第二章&quot;</span>, <span class="dv">1</span>);
    client.<span class="fu">insertHeading</span>(<span class="st">&quot;PPT&quot;</span>, <span class="dv">2</span>);
    client.<span class="fu">insertObject</span>(<span class="st">&quot;D:</span><span class="ch">\\</span><span class="st">office-test</span><span class="ch">\\</span><span class="st">ppt</span><span class="ch">\\</span><span class="st">表单设计器 - V1.0.ppt&quot;</span>);
    client.<span class="fu">insertHeading</span>(<span class="st">&quot;第三章&quot;</span>, <span class="dv">1</span>);
    client.<span class="fu">insertHeading</span>(<span class="st">&quot;Excel&quot;</span>, <span class="dv">2</span>);
    client.<span class="fu">insertObject</span>(<span class="st">&quot;D:</span><span class="ch">\\</span><span class="st">office-test</span><span class="ch">\\</span><span class="st">xls</span><span class="ch">\\</span><span class="st">all.xls&quot;</span>);
    client.<span class="fu">insertHeading</span>(<span class="st">&quot;第四章&quot;</span>, <span class="dv">1</span>);
    client.<span class="fu">insertHeading</span>(<span class="st">&quot;Word&quot;</span>, <span class="dv">2</span>);
    client.<span class="fu">insertWord</span>(<span class="st">&quot;D:</span><span class="ch">\\</span><span class="st">office-test</span><span class="ch">\\</span><span class="st">doc</span><span class="ch">\\</span><span class="st">2.doc&quot;</span>, <span class="dv">2</span>);
    client.<span class="fu">insertHeading</span>(<span class="st">&quot;第五章&quot;</span>, <span class="dv">1</span>);
    client.<span class="fu">insertHeading</span>(<span class="st">&quot;PDF&quot;</span>, <span class="dv">2</span>);
    client.<span class="fu">insertObject</span>(<span class="st">&quot;D:</span><span class="ch">\\</span><span class="st">office-test</span><span class="ch">\\</span><span class="st">pdf</span><span class="ch">\\</span><span class="st">all.pdf&quot;</span>);
    client.<span class="fu">insertHeading</span>(<span class="st">&quot;第六章&quot;</span>, <span class="dv">1</span>);
    client.<span class="fu">insertHeading</span>(<span class="st">&quot;RAR&quot;</span>, <span class="dv">2</span>);
    client.<span class="fu">insertObject</span>(<span class="st">&quot;D:</span><span class="ch">\\</span><span class="st">office-test</span><span class="ch">\\</span><span class="st">zip</span><span class="ch">\\</span><span class="st">zip.rar&quot;</span>);
    client.<span class="fu">insertHeading</span>(<span class="st">&quot;第七章&quot;</span>, <span class="dv">1</span>);
    client.<span class="fu">insertHeading</span>(<span class="st">&quot;ZIP&quot;</span>, <span class="dv">2</span>);
    client.<span class="fu">insertObject</span>(<span class="st">&quot;D:</span><span class="ch">\\</span><span class="st">office-test</span><span class="ch">\\</span><span class="st">zip</span><span class="ch">\\</span><span class="st">zip.zip&quot;</span>);
    client.<span class="fu">insertIndex</span>();
    client.<span class="fu">collect</span>();
}</code></pre>
<hr />
<pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">saveDocument</span>(String name) <span class="kw">throws</span> IOException {
    DocumentClient client = <span class="kw">new</span> <span class="fu">DocumentClient</span>(name);
    <span class="dt">byte</span>[]  b = client.<span class="fu">getDocument</span>();
    <span class="kw">if</span>(b.<span class="fu">length</span> &gt; <span class="dv">0</span>) {
        OutputStream stream = <span class="kw">new</span> FileOutputStream(<span class="kw">new</span> File(<span class="st">&quot;D:</span><span class="ch">\\</span><span class="st">&quot;</span> + name + <span class="st">&quot;.doc&quot;</span>));
        IOUtils.<span class="fu">write</span>(b, stream);
        stream.<span class="fu">close</span>();
    }<span class="kw">else</span>{
        System.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;正在转换，请稍后&quot;</span>);
    }
}</code></pre>
<h3 id="api">API</h3>
<h4 id="构造方法详细信息">构造方法详细信息</h4>
<pre><code>DocumentClient
public DocumentClient(java.lang.String docName)
参数：docName - 惟一标识  </code></pre>
<h4 id="方法详细信息">方法详细信息</h4>
<h5 id="collect">collect</h5>
<pre><code>public void collect()
归档 </code></pre>
<h5 id="getdocument">getDocument</h5>
<pre><code>public byte[] getDocument()
获取归档文件 

返回：文件流</code></pre>
<h5 id="insertfrontcover">insertFrontCover</h5>
<pre><code>public void insertFrontCover(java.lang.String filePath,
                             java.lang.String splitParam)
插入封面 

参数：filePath - 封面模板路径splitParam - 替换内容表达式</code></pre>
<h5 id="inserttitle">insertTitle</h5>
<pre><code>public void insertTitle(java.lang.String text)
插入标题 

参数：text - 文本</code></pre>
<h5 id="insertcontent">insertContent</h5>
<pre><code>public void insertContent(java.lang.String text)
插入内容 

参数：text - 文本</code></pre>
<h5 id="insertheading">insertHeading</h5>
<pre><code>public void insertHeading(java.lang.String text,
                          int type)
插入Heading 

参数：text - 文本type - Heading级别，分别是1-9</code></pre>
<h5 id="insertobject">insertObject</h5>
<pre><code>public void insertObject(java.lang.String filePath)
插入文件对象 

参数：filePath - 对象文件路径</code></pre>
<h5 id="insertword">insertWord</h5>
<pre><code>public void insertWord(java.lang.String filePath,
                       int indent)
插入需要缩进Heading的word对象 

参数：filePath - word文件路径indent - 缩进级别</code></pre>
<h5 id="insertpagebreak">insertPageBreak</h5>
<pre><code>public void insertPageBreak()
插入分页 </code></pre>
<h5 id="insertlinebreak">insertLineBreak</h5>
<pre><code>public void insertLineBreak(int line)
插入空白行 

参数：line - 行数</code></pre>
<h5 id="insertindex">insertIndex</h5>
<pre><code>public void insertIndex()
插入目录 </code></pre>
</body>
</html>
